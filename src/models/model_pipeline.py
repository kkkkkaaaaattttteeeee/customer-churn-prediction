"""
–ú–æ–¥—É–ª—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
"""

import sys
import os


class MLPipeline:
    """
    –ö–ª–∞—Å—Å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ ML
    """
    
    def __init__(self):
        self.models_info = {}
        self.metrics_info = {}
        print("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω MLPipeline")
    
    def show_ml_plan(self):
        """
        –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–ª–∞–Ω –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
        """
        print("\n" + "=" * 60)
        print("–ü–õ–ê–ù –ú–ê–®–ò–ù–ù–û–ì–û –û–ë–£–ß–ï–ù–ò–Ø")
        print("=" * 60)
        
        plan = {
            '–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö': [
                '–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö',
                '–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test (80/20)',
                '–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π'
            ],
            '–≠—Ç–∞–ø 2: –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏': [
                '–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (baseline)',
                '–°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å (RandomForest)',
                '–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost/LightGBM)'
            ],
            '–≠—Ç–∞–ø 3: –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π': [
                '–ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è (5 folds)',
                '–ú–µ—Ç—Ä–∏–∫–∏: Accuracy, Precision, Recall, F1, ROC-AUC',
                '–ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ (confusion matrix)'
            ],
            '–≠—Ç–∞–ø 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è': [
                '–ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (GridSearch/RandomSearch)',
                '–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ (class_weight, SMOTE)',
                '–û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (feature importance)'
            ],
            '–≠—Ç–∞–ø 5: –ü—Ä–æ–¥–∞–∫—à–Ω': [
                '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (pickle/joblib)',
                '–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏',
                '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ hold-out –≤—ã–±–æ—Ä–∫–µ'
            ]
        }
        
        for stage, tasks in plan.items():
            print(f"\nüìã {stage}:")
            for task in tasks:
                print(f"   ‚Ä¢ {task}")
        
        return plan
    
    def get_available_models(self):
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
        """
        models = [
            {
                'name': 'LogisticRegression',
                'type': '–õ–∏–Ω–µ–π–Ω–∞—è',
                'pros': '–ë—ã—Å—Ç—Ä–∞—è, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–∞—è',
                'cons': '–õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è'
            },
            {
                'name': 'RandomForest',
                'type': '–ê–Ω—Å–∞–º–±–ª—å –¥–µ—Ä–µ–≤—å–µ–≤',
                'pros': '–†–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å—é, –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤',
                'cons': '–ú–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è'
            },
            {
                'name': 'XGBoost',
                'type': '–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥',
                'pros': '–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è',
                'cons': '–¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏'
            },
            {
                'name': 'LightGBM',
                'type': '–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥',
                'pros': '–û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π',
                'cons': '–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é'
            }
        ]
        
        print("\n" + "=" * 60)
        print("–î–û–°–¢–£–ü–ù–´–ï –ú–û–î–ï–õ–ò ML")
        print("=" * 60)
        
        for model in models:
            print(f"\nü§ñ {model['name']} ({model['type']}):")
            print(f"   ‚úÖ {model['pros']}")
            print(f"   ‚ö†Ô∏è  {model['cons']}")
        
        return models
    
    def get_evaluation_metrics(self):
        """
        –û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –æ—Ü–µ–Ω–∫–∏
        """
        metrics = [
            {
                'name': 'Accuracy',
                'formula': '(TP + TN) / (TP + TN + FP + FN)',
                'when_use': '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã'
            },
            {
                'name': 'Precision',
                'formula': 'TP / (TP + FP)',
                'when_use': '–í–∞–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å FP (–ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è)'
            },
            {
                'name': 'Recall',
                'formula': 'TP / (TP + FN)',
                'when_use': '–í–∞–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å FN (–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ churn)'
            },
            {
                'name': 'F1-Score',
                'formula': '2 * (Precision * Recall) / (Precision + Recall)',
                'when_use': '–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É Precision –∏ Recall'
            },
            {
                'name': 'ROC-AUC',
                'formula': '–ü–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π',
                'when_use': '–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏'
            }
        ]
        
        print("\n" + "=" * 60)
        print("–ú–ï–¢–†–ò–ö–ò –û–¶–ï–ù–ö–ò –ú–û–î–ï–õ–ï–ô")
        print("=" * 60)
        
        for metric in metrics:
            print(f"\nüìä {metric['name']}:")
            print(f"   –§–æ—Ä–º—É–ª–∞: {metric['formula']}")
            print(f"   –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: {metric['when_use']}")
        
        return metrics
    
    def show_hyperparameter_tuning(self):
        """
        –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–ª–∞–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        """
        print("\n" + "=" * 60)
        print("–ù–ê–°–¢–†–û–ô–ö–ê –ì–ò–ü–ï–†–ü–ê–†–ê–ú–ï–¢–†–û–í")
        print("=" * 60)
        
        tuning_plan = {
            'RandomForest': [
                'n_estimators: [100, 200, 300]',
                'max_depth: [5, 10, 15, None]',
                'min_samples_split: [2, 5, 10]'
            ],
            'XGBoost': [
                'learning_rate: [0.01, 0.1, 0.3]',
                'max_depth: [3, 5, 7]',
                'n_estimators: [100, 200]'
            ],
            'LightGBM': [
                'num_leaves: [31, 50, 100]',
                'learning_rate: [0.01, 0.1]',
                'n_estimators: [100, 200]'
            ]
        }
        
        for model, params in tuning_plan.items():
            print(f"\n‚öôÔ∏è  {model}:")
            for param in params:
                print(f"   ‚Ä¢ {param}")
    
    def create_model_card_template(self):
        """
        –°–æ–∑–¥–∞–µ—Ç —à–∞–±–ª–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏ –º–æ–¥–µ–ª–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
        """
        print("\n" + "=" * 60)
        print("–®–ê–ë–õ–û–ù –ö–ê–†–¢–û–ß–ö–ò –ú–û–î–ï–õ–ò")
        print("=" * 60)
        
        template = """
üìã –ö–ê–†–¢–û–ß–ö–ê –ú–û–î–ï–õ–ò

–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏: [–ò–º—è_–º–æ–¥–µ–ª–∏]
–¢–∏–ø –∑–∞–¥–∞—á–∏: –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
–î–∞—Ç–∞ –æ–±—É—á–µ–Ω–∏—è: [YYYY-MM-DD]
–í–µ—Ä—Å–∏—è: 1.0

üìä –ú–ï–¢–†–ò–ö–ò –ù–ê –¢–ï–°–¢–û–í–û–ô –í–´–ë–û–†–ö–ï:
‚Ä¢ Accuracy: [–∑–Ω–∞—á–µ–Ω–∏–µ]
‚Ä¢ Precision: [–∑–Ω–∞—á–µ–Ω–∏–µ]
‚Ä¢ Recall: [–∑–Ω–∞—á–µ–Ω–∏–µ]
‚Ä¢ F1-Score: [–∑–Ω–∞—á–µ–Ω–∏–µ]
‚Ä¢ ROC-AUC: [–∑–Ω–∞—á–µ–Ω–∏–µ]

‚öôÔ∏è –ì–ò–ü–ï–†–ü–ê–†–ê–ú–ï–¢–†–´:
‚Ä¢ [–ø–∞—Ä–∞–º–µ—Ç—Ä1]: [–∑–Ω–∞—á–µ–Ω–∏–µ]
‚Ä¢ [–ø–∞—Ä–∞–º–µ—Ç—Ä2]: [–∑–Ω–∞—á–µ–Ω–∏–µ]
‚Ä¢ [–ø–∞—Ä–∞–º–µ—Ç—Ä3]: [–∑–Ω–∞—á–µ–Ω–∏–µ]

üéØ –¢–û–ü-5 –í–ê–ñ–ù–´–• –ü–†–ò–ó–ù–ê–ö–û–í:
1. [–ø—Ä–∏–∑–Ω–∞–∫1]: [–≤–∞–∂–Ω–æ—Å—Ç—å]
2. [–ø—Ä–∏–∑–Ω–∞–∫2]: [–≤–∞–∂–Ω–æ—Å—Ç—å]
3. [–ø—Ä–∏–∑–Ω–∞–∫3]: [–≤–∞–∂–Ω–æ—Å—Ç—å]
4. [–ø—Ä–∏–∑–Ω–∞–∫4]: [–≤–∞–∂–Ω–æ—Å—Ç—å]
5. [–ø—Ä–∏–∑–Ω–∞–∫5]: [–≤–∞–∂–Ω–æ—Å—Ç—å]

üìÅ –î–ê–ù–ù–´–ï:
‚Ä¢ –†–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏: [—á–∏—Å–ª–æ]
‚Ä¢ –†–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏: [—á–∏—Å–ª–æ]
‚Ä¢ –ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤: [—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ]

üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï:
‚Ä¢ –§–∞–π–ª –º–æ–¥–µ–ª–∏: [–ø—É—Ç—å]
‚Ä¢ –î–∞—Ç–∞—Å–µ—Ç: [—Å—Å—ã–ª–∫–∞]
‚Ä¢ –ö–æ–¥ –æ–±—É—á–µ–Ω–∏—è: [—Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–∫—Ä–∏–ø—Ç]
"""
        
        print(template)
        return template
    
    def summary(self):
        """
        –°–≤–æ–¥–∫–∞ –ø–æ –ø–∞–π–ø–ª–∞–π–Ω—É ML
        """
        print("\n" + "=" * 60)
        print("–°–í–û–î–ö–ê –ü–û ML –ü–ê–ô–ü–õ–ê–ô–ù–£")
        print("=" * 60)
        
        print(f"\nüéØ –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è: Churn (–æ—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤)")
        print(f"üìä –¢–∏–ø –∑–∞–¥–∞—á–∏: –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è")
        print(f"üîß –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã: 5")
        print(f"ü§ñ –ú–æ–¥–µ–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: 4")
        print(f"üìà –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏: 5")
        
        print("\nüöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
        print("   1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö")
        print("   2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å feature engineering")
        print("   3. –û–±—É—á–∏—Ç—å baseline –º–æ–¥–µ–ª—å (–ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é)")
        print("   4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–Ω—Å–∞–º–±–ª–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã")
        print("   5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏")


def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª—è
    """
    print("üß† –ú–û–î–£–õ–¨ –ú–ê–®–ò–ù–ù–û–ì–û –û–ë–£–ß–ï–ù–ò–Ø")
    
    pipeline = MLPipeline()
    pipeline.show_ml_plan()
    pipeline.get_available_models()
    pipeline.get_evaluation_metrics()
    pipeline.show_hyperparameter_tuning()
    pipeline.create_model_card_template()
    pipeline.summary()
    
    print("\n‚úÖ –ú–æ–¥—É–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é")


if __name__ == "__main__":
    main()